{% extends "master.html" %}

{% block footer %}
  {% include '../../include/footer.html' %}
{% endblock %}


{% block content %}
  <div class="container">
    <div class="card px-3">
      <div class="row">
        <div class="col-lg-7 card-body border-end p-md-8">
          <h4 class="mb-2">Phương Thức Thanh Toán</h4>
          <div class="row g-5 py-8">
            <div class="col-md col-lg-12 col-xl-6">
              <div class="form-check custom-option custom-option-basic checked">
                <label class="form-check-label custom-option-content form-check-input-payment d-flex gap-4 align-items-center" for="customRadioVisa">
                  <input name="customRadioTemp" class="form-check-input" type="radio" value="credit-card" id="customRadioVisa" checked="">
                  <span class="custom-option-body">
                    <img src="https://demos.themeselection.com/sneat-bootstrap-html-admin-template/assets/img/icons/payments/visa-light.png" alt="visa-card" width="58">
                    <span class="ms-4 fw-medium text-heading">Thẻ Tín Dụng</span>
                  </span>
                </label>
              </div>
            </div>
            <div class="col-md col-lg-12 col-xl-6">
              <div class="form-check custom-option custom-option-basic">
                <label class="form-check-label custom-option-content form-check-input-payment d-flex gap-4 align-items-center" for="customRadioPaypal">
                  <input name="customRadioTemp" class="form-check-input" type="radio" value="paypal" id="customRadioPaypal">
                  <span class="custom-option-body">
                    <img src="https://demos.themeselection.com/sneat-bootstrap-html-admin-template/assets/img/icons/payments/paypal-light.png" alt="paypal" width="58">
                    <span class="ms-4 fw-medium text-heading">Thẻ ghi nợ</span>
                  </span>
                </label>
              </div>
            </div>
            <div class="col-md col-lg-12 col-xl-6">
              <div class="form-check custom-option custom-option-basic">
                <label class="form-check-label custom-option-content form-check-input-payment d-flex gap-4 align-items-center" for="customRadioCash">
                  <input name="customRadioTemp" class="form-check-input" type="radio" value="cash" id="customRadioCash">
                  <span class="custom-option-body">
                    <img src="https://demos.themeselection.com/sneat-bootstrap-html-admin-template/assets/img/icons/payments/paypal-light.png" alt="cash" width="58">
                    <span class="ms-4 fw-medium text-heading">Tiền mặt</span>
                  </span>
                </label>
              </div>
            </div>
          </div>
          <h4 class="mb-6">Thông Tin Người Dùng</h4>
            <form>
              <div class="row g-6">
                <div class="col-md-6">
                  <label class="form-label" for="billings-email">Địa Chỉ Email</label>
                  <input type="text" id="billings-email" class="form-control" placeholder="nguyenvana1234@gmail.com">
                </div>
                <div class="col-md-6">
                  <label class="form-label" for="billings-password">Mật Khẩu</label>
                  <input type="password" id="billings-password" class="form-control" placeholder="Password">
                </div>
                <div class="col-md-6">
                  <label class="form-label" for="billings-country">Quê Quán</label>
                  <input type="text" id="billings-country" class="form-control" placeholder="Hà Nội">
                </div>
                <div class="col-md-6">
                  <label for="smallInput" class="form-label">Số điện thoại</label>
                  <input type="text" id="billings-zip" class="form-control billings-zip-code" placeholder="0123456789" />
                </div>
                <div> 
                </div>
              </div>
            </form>
            <div id="form-credit-card">
                  <h4 class="mt-8 mb-6">Thông Tin Thẻ</h4>
                  <form>
                    <div class="row g-6">
                      <div class="col-12">
                        <label class="form-label" for="billings-card-num">Số Tài Khoản</label>
                        <div class="input-group input-group-merge">
                          <input type="text" id="billings-card-num" class="form-control billing-card-mask" placeholder="7465 8374 5837 5067" aria-describedby="paymentCard">
                          <span class="input-group-text cursor-pointer p-1" id="paymentCard"><span class="card-type"></span></span>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label" for="billings-card-name">Họ Và Tên</label>
                        <input type="text" id="billings-card-name" class="form-control" placeholder="Nguyễn Thị Ngọc Trâm">
                      </div>
                      <div class="col-md-3">
                        <label class="form-label" for="billings-card-date">Ngày Hết Hạn</label>
                        <input type="text" id="billings-card-date" class="form-control billing-expiry-date-mask" placeholder="MM/YY">
                      </div>
                      <div class="col-md-3">
                        <label class="form-label" for="billings-card-cvv">CVV</label>
                        <input type="text" id="billings-card-cvv" class="form-control billing-cvv-mask" maxlength="3" placeholder="8386">
                      </div>
                      
                    </div>
                  </form>
                </div>
              </div>
              <div class="col-lg-5 card-body p-md-8">
    <h4 class="mb-2">Chi Tiết Hóa Đơn</h4>
    <div class="bg-lighter p-6 rounded">
        <div class="d-flex align-items-center mb-4">
            <h1 class="text-heading mb-0">{{ request.GET.cost_court }} VND</h1>
        </div>
    </div>
    <div class="mt-5">
        <div class="d-flex justify-content-between align-items-center">
            <p class="mb-0"><strong>Tên Sân:</strong> {{ request.GET.name_court }}</p>
        </div>
        <div class="d-flex justify-content-between align-items-center mt-2">
            <p class="mb-0"><strong>Loại Sân:</strong> {{ request.GET.type_court }}</p>
        </div>
        <div class="d-flex justify-content-between align-items-center mt-2">
          <p class="mb-0"><strong>Thời Gian:</strong> {{ request.GET.start_time }} - {{ request.GET.end_time }}</p>
        </div>
        <hr>
        <div class="d-flex justify-content-between align-items-center mt-4 pb-1">
            <p class="mb-0">Tổng</p>
            <h6 class="mb-0">{{ cost_court }} VND</h6>
        </div>
        <div class="d-grid mt-5">
            <button class="btn btn-success">
                <span class="me-2">Thanh toán</span>
                <i class="icon-base bx bx-right-arrow-alt scaleX-n1-rtl"></i>
            </button>
        </div>
    </div>
</div>

  <script>
    document.querySelectorAll('input[name="customRadioTemp"]').forEach(input => {
      input.addEventListener('change', function() {
        if (this.value === 'cash') {
          document.getElementById('form-credit-card').style.display = 'none';
        } else {
          document.getElementById('form-credit-card').style.display = 'block';
        }
      });
    });
  </script>
  <script>
    document.querySelector('.btn-success').addEventListener('click', function(event) {
      event.preventDefault(); // Ngăn form submit mặc định
  
      // Lấy phương thức thanh toán
      let paymentMethod = document.querySelector('input[name="customRadioTemp"]:checked')?.value;
  
      // Lấy dữ liệu từ form
      let email = document.getElementById('billings-email')?.value.trim();
      let password = document.getElementById('billings-password')?.value.trim();
      let country = document.getElementById('billings-country')?.value.trim();
      let phone = document.getElementById('billings-zip')?.value.trim();
      let cardNumber = document.getElementById('billings-card-num')?.value.trim();
      let cardName = document.getElementById('billings-card-name')?.value.trim();
      let expiryDate = document.getElementById('billings-card-date')?.value.trim();
      let cvv = document.getElementById('billings-card-cvv')?.value.trim();
  
      let errorMessage = "";
  
      // Kiểm tra thông tin bắt buộc
      if (!email) errorMessage += "- Vui lòng nhập email.\n";
      if (!password) errorMessage += "- Vui lòng nhập mật khẩu.\n";
      if (!country) errorMessage += "- Vui lòng nhập quê quán.\n";
      if (!phone) errorMessage += "- Vui lòng nhập số điện thoại.\n";
  
      // Nếu chọn thanh toán bằng thẻ, kiểm tra thông tin thẻ
      if (paymentMethod === "credit-card" || paymentMethod === "paypal") {
          if (!cardNumber) errorMessage += "- Vui lòng nhập số tài khoản.\n";
          if (!cardName) errorMessage += "- Vui lòng nhập họ và tên chủ thẻ.\n";
          if (!expiryDate) errorMessage += "- Vui lòng nhập ngày hết hạn.\n";
          if (!cvv) errorMessage += "- Vui lòng nhập CVV.\n";
      }
  
      // Nếu có lỗi, hiển thị thông báo và dừng xử lý
      if (errorMessage) {
          alert("Thanh toán thất bại! \n" + errorMessage);
          return;
      }
  
      // Giả lập kiểm tra thanh toán (thực tế nên gọi API)
      let paymentSuccess = Math.random() > 0.5; // Xác suất thành công 50%
  
      if (paymentSuccess) {
          alert('Thanh toán thành công! Quay về trang chủ.');
          window.location.href = '/';
      } else {
          alert('Thanh toán thất bại do lỗi kỹ thuật! Vui lòng thử lại.');
          window.location.href = '/Payments';
      }
  });
  
  
</script>

  
{% endblock %}
